# Quantum Purse

Quantum Purse is a quantum-safe wallet for CKB blockchain. It started out in the form of a static web application and now has fully evolved into a native PC app. Any deployment mentioned after this only means serving Quantum Purse code for your browser remotely!

CKB addresses generated by Quantum Purse are quantum-safe, so assets transferred to these addresses remain secure against quantum threats.

Currently using an **under development** [CKB quantum resistant lockscript](https://github.com/cryptape/quantum-resistant-lock-script).

###### <u>Feature list</u>:

| Feature            | Details |
|--------------------|---------|
| **Signature type** | FIPS205 (SPHINCS+) |
| **Store model**    | Indexed DB |
| **Mnemonic standard**| Custom BIP39 English |
| **Local encryption** | AES256 |
| **Key derivation** | Scrypt |
| **Authentication** | Password |
| **Password hashing** | Scrypt |
| **RPC endpoint** | Not required |
| **Light Client** | Supported (Chrome-based & Safari) |

###### Overview
<img width="628" alt="overview" src="https://github.com/user-attachments/assets/433a25dd-2845-4384-b9a3-e2374aac3227" />

## Sha2-256s / Sha2-128s or which?
All 12 NIST-approved SPHINCS+ parameter sets are supported by Quantum Purse. These parameter sets are the combinational results of:
- 2 hashing algorithms: `Sha2`, `Shake`
- 3 security parameter length: `128 bit`, `192 bit`, `256 bit`
- 2 optimization methods: `s`(small signature), `f`(fast signature generation)

##### <u>Post Quantum security level</u>
NIST doesn't define the strength for each variant using precise estimates of the number of “bits of security” but offers 5 broad security strength categories. Refer to the [NIST call for quantum safe crypto proposal](https://csrc.nist.gov/CSRC/media/Projects/Post-Quantum-Cryptography/documents/call-for-proposals-final-dec-2016.pdf) for more details. Any attack that breaks the relevant security definition must require computational resources comparable to or greater than those required for:
1) Key search on a block cipher with a 128-bit key (e.g. AES128)
2) Collision search on a 256-bit hash function (e.g. SHA256/ SHA3-256)
3) Key search on a block cipher with a 192-bit key (e.g. AES192)
4) Collision search on a 384-bit hash function (e.g. SHA384/ SHA3-384)
5) Key search on a block cipher with a 256-bit key (e.g. AES 256)

SPHINCS+ variant with security parameter length of 128, 192, 256 fall into the category 1, 3, 5 respectively.

##### <u>Recommendation</u>
For CKB, `Sha2-128s`, `Sha2-192s` and `Sha2-256s` are recommended because:
- 's' variant is on-chain friendly as it's fast and light weight. The tradeoff here is that signature generation on QuantumPurse takes longer.
- `Sha2` is faster than `Shake`.

If you have no reference, `Sha2-256s` is good to start with.

## 73 CKB
Due to the larger size of the quantum lock script:
- Minimum CKB per quantum-safe cell is 73 CKB
- Smaller transfers will be rejected by CKB blockchain.

## Light client

Quantum Purse is a true light wallet. It runs its own [CKB light client node](https://github.com/nervosnetwork/ckb-light-client) directly in your browser and connects directly to the CKB network without middle RPC enpoint. The light client sync status such as peers connected and sync percentage are displayed on the right side of the app's header:

<img width="240" alt="Screenshot 2025-04-16 at 5 58 02 PM" src="https://github.com/user-attachments/assets/c99c8750-ef1d-4416-8344-b79aefd5098b" />

**Important:**
- It takes 5-10 seconds to establish connections to other nodes.
- Another 10 - 30 seconds to fully sync a newly added account.
- For a smooth experience, ensure your PEERS value is greater than 0 before creating your wallet.
- If you don't, no worries. In such case you'd notice that sync percentage grows very slowly and may want to set `starting block` for each account manually after creating wallet successfully.
- One new account starts syncing at block 0 will render other accounts sync to wait until this account catches up. Provide proper starting blocks properly for a smooth experience.

## Wallet recovery

When you import your seed phrase into Quantum Purse, it automatically restores your wallets by generating child keys sequentially, starting from index 1. The recovery process continues until it encounters 5 consecutive empty accounts (i.e., accounts with no transaction history).

**Important:** Currently, recovering wallet on a newly setup Quantum Purse will result in only the first account being created because Light Client is too slow for this process. In such case, create accounts, determine starting block via ckb explorer then set starting blocks manually via each account's context menu.

## How to use

The following flag in `src/core/config.ts` switch controls mainnet/testnet. Change that to `true` for main-net and leave it `false` for test-net:
```typescript
export const IS_MAIN_NET = false;
```

Currently, the following are the recommended ways to use this software, ranked from most to least preferred:
1. If you're a normal user, download QuantumPurse in the release page (TBD), verify SHA sum against the published one, then use it.
2. If possible, build a native pc app via `npm run build:app` and choose an installer for your platform.
3. For development purpose, serve it locally with webpack via `npm run start:web`. To use the wallet this way, refer to [Geting started](#getting-started) section. You can find other ways to serve the built `dist/` folder locally too.

## Demo
https://quantum-purse.vercel.app/

## Getting started
###### <u>Dependencies</u>
1. Node >=20.
2. Chrome-based or safari browsers.

###### <u>Command list (In no sequential order. Pick any command)</u>
```shell
# Install dependencies
npm install

# start web app in development mode
npm run start:web

# Build web app core
npm run build:web

# start native app in development mode
npm run start:app

# Build native app for mac, win, linux
npm run build:app

# Run test
npm run test
```

## Contribution
Any PR to `develop` branch is welcomed. Have an idea or have found an issue? Feel free to open a github issue to let me know.

## Notes

1. As of 2025, quantum resistance is still experimental. Use this software at your own risk.
2. Back up your mnemonic seed. Losing your seed means losing access to your wallet.
3. Quantum Purse does NOT store your passwords. Passwords are used only temporarily to encrypt and decrypt your secret data.
4. IndexedDB stores only public data and encrypted secret data. Your SPHINCS+ private keys remain protected as long as your password is strong enough.
5. What is a strong password? Quantum Purse does guide you in wallet creation to create a strong password but it will be best for you to come up with your own that passes Quantum Purse's validation.
6. Forgot your password? Recover access by importing your seed phrase and setting a new password instantly.
7. Need help? Report issues on GitHub!

## Commentary
Quantum Purse requires password for each key-related function. While the application securely erases (zeroizes) sensitive data after processing, **password input in JS environment doesn't offer complete zeroization over passwords/seed phrases**. So password/seed phrase input (seed phrase exporting included) remains a potential attack vector—this is in fact the weakest link in all password-based cryptocurrency wallets.

Until a proper SPHINCS+ hardware wallet is available for secure key management, follow these best practices to maximize security:

1. Use a dedicated device with minimal software (including web extensions) installed to run Quantum Purse.
2. You have to have a strong enough password if you want to keep the wallet on your computer because that's your weakest link.
3. Terminate the web browser after completing a transaction. Ideally, power off your computer to wipe residual password-related data from RAM.
4. This is coming so stay tuned! For maximum security, use an air-gapped device (one with no internet connection) to run Quantum Purse. To sign a transaction:
   - Construct an unsigned transaction on an internet-connected device using your public address.
   - Transfer it via a secure USB drive (ensure it's malware-free) to the air-gapped device.
   - Sign the transaction on the air-gapped device.
   - Transfer the signed transaction back via USB and broadcast it using a tool like [this one](https://explorer.nervos.org/tools/broadcast-tx). You might want to test the broadcaster with JoyID signed transactions first!
   - This effectively turns your dedicated device into a quantum-safe offline signer.